<html>
	<head>
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
  </body>
    <script src="js/three.js"></script>
    <script src="js/OrbitControls.js"></script>
    <script>

        var keyPressed = [];
        var C_KEY_SHIFT = 16;
        var C_KEY_CTRL = 17;
        var C_KEY_ALT = 18;

        var C_KEY_LEFT = 37;
        var C_KEY_DOWN = 40;
        var C_KEY_RIGHT = 39;
        var C_KEY_UP = 38;

        var renderer = null;
        var scene = null;
        var camera = null;

        function start()
        {

            renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );
            
            setKeyboard();

            // Init camera.
            var fov = 45;
            var aspect = 2;  // the canvas default
            var near = 0.1;
            var far = 100;
            camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
            camera.position.set(0, 50, 50);
            camera.lookAt( 0, 0, 0 );

			// Init orbit
            var controls = new THREE.OrbitControls( camera, renderer.domElement );
            
			// Init scene
            scene = new THREE.Scene();
			scene.background = new THREE.Color('black');

            addLightToScene(scene);

			// Add board
            {
                var planeSize = 10;

                var loader = new THREE.TextureLoader();
                var texture = loader.load('https://threejsfundamentals.org/threejs/resources/images/checker.png');
                texture.wrapS = THREE.RepeatWrapping;
                texture.wrapT = THREE.RepeatWrapping;
                texture.magFilter = THREE.NearestFilter;
                var repeats = 5;
                texture.repeat.set(repeats, repeats);

                var planeGeo = new THREE.PlaneBufferGeometry(planeSize, planeSize);
                console.log(planeGeo.uvs);
                var planeMat = new THREE.MeshPhongMaterial({
                map: texture,
                side: THREE.DoubleSide,
                });
                var mesh = new THREE.Mesh(planeGeo, planeMat);
                mesh.rotation.x = Math.PI/2 * -.5;
                scene.add(mesh);
            }

			addCustomObject(scene);

            animate();
        }

        function setKeyboard()
        {
            document.onkeydown = function(event) 
            {
                keyPressed[event.keyCode] = true;
                return true;
            };

            document.onkeyup = function(event) 
            {
                keyPressed[event.keyCode] = false;
                return true;
            }
        }

        function addLightToScene(_scene)
        {
            var skyColor = 0xB1E1FF;  // light blue
            var groundColor = 0xB97A20;  // brownish orange
            var intensity = 1;
            var light = new THREE.HemisphereLight(skyColor, groundColor, intensity);
            _scene.add(light);
        }

        function addCustomObject(_scene)
        {
            var loader = new THREE.TextureLoader();
                //var texture = loader.load('https://threejsfundamentals.org/threejs/resources/images/checker.png');
                var texture = loader.load(mockData(""));
                texture.wrapS = THREE.RepeatWrapping;
                texture.wrapT = THREE.RepeatWrapping;
                texture.magFilter = THREE.NearestFilter;
                var repeats = 20 / 2;
                texture.repeat.set(repeats, repeats);

            var mycube_geometry = new THREE.Geometry();

            mycube_geometry.vertices.push(
                new THREE.Vector3(0.00, 0.00, 0.00),
                new THREE.Vector3(0.00, 20.00, 0.00),
                new THREE.Vector3(30.00, 20.00, 0.00),
                new THREE.Vector3(30.00, 0.00, 0.00),
                new THREE.Vector3(0.00, 0.00, 2.00),
                new THREE.Vector3(0.00, 20.00, 2.00),
                new THREE.Vector3(30.00, 20.00, 2.00),
                new THREE.Vector3(30.00, 0.00, 2.00)
            );

            mycube_geometry.faces.push( 
                new THREE.Face3( 0, 1, 2),
                new THREE.Face3( 0, 2, 3),
                new THREE.Face3( 3, 2, 6),
                new THREE.Face3( 3, 6, 7),
                new THREE.Face3( 7, 6, 5),
                new THREE.Face3( 7, 5, 4),
                new THREE.Face3( 4, 5, 1),
                new THREE.Face3( 4, 1, 0),
                new THREE.Face3( 1, 5, 6),
                new THREE.Face3( 1, 6, 2),
                new THREE.Face3( 7, 4, 0),
                new THREE.Face3( 7, 0, 3)
            );

            
            mycube_geometry.faceVertexUvs[0].push( 
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(0.0, 0.0), new THREE.Vector2(1.0, 0.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(1.0, 0.0), new THREE.Vector2(1.0, 1.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(0.0, 0.0), new THREE.Vector2(1.0, 0.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(1.0, 0.0), new THREE.Vector2(1.0, 1.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(0.0, 0.0), new THREE.Vector2(1.0, 0.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(1.0, 0.0), new THREE.Vector2(1.0, 1.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(0.0, 0.0), new THREE.Vector2(1.0, 0.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(1.0, 0.0), new THREE.Vector2(1.0, 1.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(0.0, 0.0), new THREE.Vector2(1.0, 0.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(1.0, 0.0), new THREE.Vector2(1.0, 1.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(0.0, 0.0), new THREE.Vector2(1.0, 0.0)],
                [new THREE.Vector2(0.0, 1.0), new THREE.Vector2(1.0, 0.0), new THREE.Vector2(1.0, 1.0)]
            );

            //var mycube_material = new THREE.MeshPhongMaterial({color: "#8AC"});
            var mycube_material = new THREE.MeshPhongMaterial({map: texture, side: THREE.DoubleSide});

            //mycube_geometry.computeBoundingSphere();
            mycube_geometry.computeFaceNormals();
            //mycube_geometry.computeVertexNormals(); 

            //mycube_geometry.computeFlatVertexNormals(); 

            var mycube_mesh = new THREE.Mesh(mycube_geometry, mycube_material );
            _scene.add( mycube_mesh );
        }
        
        function animate(_time) 
        {
            processInput();
           
            render();

            requestAnimationFrame(animate);
        }

        function processInput(time) 
        {
			var updateCamera = false;
					
            if (isKeyPressed(C_KEY_LEFT) === true)
            {
                updateCamera = true;
                camera.position.x -= 0.5;
            }

            if (isKeyPressed(C_KEY_RIGHT) === true)
            {
                updateCamera = true;
                camera.position.x += 0.5;
            }

            if (isKeyPressed(C_KEY_UP) === true)
            {
                updateCamera = true;
                
                if (isKeyPressed(C_KEY_SHIFT) === true)
                    camera.position.y += 0.5;
                else
                    camera.position.z -= 0.5;
            }

            if (isKeyPressed(C_KEY_DOWN) === true)
            {
                updateCamera = true;

                if (isKeyPressed(C_KEY_SHIFT) === true)
                    camera.position.y -= 0.5;
                else
                    camera.position.z += 0.5;
            }

            if (updateCamera === true)
            {
                //camera.up.set( 0, 0, 1 );
                camera.lookAt( 0, 0, 0 );
                camera.updateProjectionMatrix();
                console.log("x:", camera.position.x, " y:" + camera.position.y + " z:", camera.position.z);
            }


        };

        function render()
        {
            if (resizeRendererToDisplaySize(renderer)) 
            {
                var canvas = renderer.domElement;
                camera.aspect = canvas.clientWidth / canvas.clientHeight;
                camera.updateProjectionMatrix();
            }

            renderer.render(scene, camera);
        }

        function isKeyPressed(_scanCode) 
        {
            return keyPressed[_scanCode];
        }

        function resizeRendererToDisplaySize(renderer) 
        {
            var canvas = renderer.domElement;
            var width = canvas.clientWidth;
            var height = canvas.clientHeight;
            var needResize = canvas.width !== width || canvas.height !== height;
            if (needResize) 
            {
                renderer.setSize(width, height, false);
            }
            return needResize;
        }

        function mockData(_key)
        {
            return 'data:image/jpeg;base64,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';
        }
		start();
    </script>
</html>
